---
pagination:
  data: allNames
  size: 1
  alias: nameData
permalink: /names/{{ nameData.gender | lower }}/{{ nameData.uniqueSlug }}/
---

{% extends "base.njk" %}

{% block title %}{{ nameData.name }} - {{ siteConfig.title }}{% endblock %}
{% block description %}Discover {{ nameData.name }}: A {{ nameData.gender }}'s name ranked #{{ nameData.rank }} with detailed popularity trends and historical data.{% endblock %}

{% block content %}
<article class="bg-white rounded-lg p-8 shadow-sm">
  <h1 class="text-5xl font-bold mb-2 text-gray-900">{{ nameData.name }}</h1>

  {% if nameData.gender %}
  <p class="text-xl text-gray-600 mb-8">{{ nameData.gender }}'s Name</p>
  {% endif %}

  <div class="mb-8">
    <table class="min-w-full">
      <tbody class="border-t border-gray-300">
        <tr class="border-b border-gray-300">
          <th scope="row" class="py-3 pr-4 text-left font-normal text-gray-900">Current rank</th>
          <td class="py-3 text-right font-bold text-gray-900">#{{ nameData.rank }}</td>
        </tr>
        <tr class="border-b border-gray-300">
          <th scope="row" class="py-3 pr-4 text-left font-normal text-gray-900">Babies named {{ nameData.name }}</th>
          <td class="py-3 text-right font-bold text-gray-900">{{ nameData.count }}</td>
        </tr>
        {% if nameData.relatedNames and nameData.relatedNames.length > 0 %}
        {% set relatedCount2024 = nameData.relatedTotalCountFrom1996[28] %}
        <tr class="border-b border-gray-300">
          <th scope="row" class="py-3 pr-4 text-left font-normal text-gray-900">Babies named related names</th>
          <td class="py-3 text-right font-bold text-gray-900">{% if relatedCount2024 != 'x' %}{{ relatedCount2024 }}{% else %}—{% endif %}</td>
        </tr>
        {% endif %}
      </tbody>
    </table>

    {% if nameData.relatedNamesWithRank and nameData.relatedNamesWithRank.length > 0 %}
    {% set sortedRelated = nameData.relatedNamesWithRank | sort(false, false, 'rank') %}
    <p class="text-base text-gray-700 mt-4">
      <span class="font-semibold">Related names:</span>
      {%- for relName in sortedRelated -%}
        {%- if relName.rank -%}
          {{ relName.name }} (#{{ relName.rank }})
        {%- else -%}
          {{ relName.name }}
        {%- endif -%}
        {%- if not loop.last %}, {% endif -%}
      {%- endfor -%}
    </p>
    {% endif %}
  </div>

  {% if nameData.rankHistoric and nameData.rankHistoric.length > 0 %}
  <div class="mb-8">
    <h2 class="text-2xl font-bold mb-2 text-gray-900">Historic Rankings</h2>
    <p class="text-gray-700 mb-4">Top 100 rankings from 1904 to 2024</p>

    {% if nameData.historicClassification %}
    <div class="mb-4 bg-amber-50 rounded-lg p-4 border-l-4 border-amber-500">
      <p class="text-sm font-semibold text-gray-700 mb-1">
        Classification: <span class="text-amber-600">{{ nameData.historicClassification }}</span>
      </p>
      {% if classificationDescriptions.historic[nameData.historicClassification] %}
      <p class="text-sm text-gray-600">{{ classificationDescriptions.historic[nameData.historicClassification] }}</p>
      {% endif %}
    </div>
    {% endif %}

    <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-4 mb-4">
      <div id="historic-chart" class="w-full" style="height: 300px;"></div>
    </div>

    <details class="mt-4">
      <summary class="cursor-pointer bg-white rounded-lg p-4 hover:bg-gray-50 font-semibold text-gray-700 select-none border border-gray-200">
        View Data Table
      </summary>
      <div class="mt-2 bg-white rounded-lg overflow-hidden border border-gray-200">
        <div class="overflow-x-auto">
          <table class="min-w-full divide-y divide-gray-200">
            <thead class="bg-gray-50">
              <tr>
                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Decade</th>
                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Rank</th>
              </tr>
            </thead>
            <tbody class="bg-white divide-y divide-gray-200">
              {% for rank in nameData.rankHistoric %}
              {% set decade = 1900 + (loop.index0 * 10) %}
              <tr class="{% if loop.index0 % 2 == 0 %}bg-white{% else %}bg-gray-50{% endif %} hover:bg-amber-50">
                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">{{ decade }}s</td>
                <td class="px-6 py-4 whitespace-nowrap text-sm {% if rank != 'x' %}text-amber-600 font-semibold{% else %}text-gray-400{% endif %}">
                  {% if rank != 'x' %}#{{ rank }}{% else %}Not in Top 100{% endif %}
                </td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      </div>
    </details>
  </div>
  {% endif %}

  {% if nameData.rankFrom1996 and nameData.rankFrom1996.length > 0 %}
  <div class="mb-8">
    <h2 class="text-2xl font-bold mb-2 text-gray-900">Modern Rankings</h2>
    <p class="text-gray-700 mb-4">Rankings from 1996 to 2024 (29 years)</p>

    {% if nameData.recentClassification %}
    <div class="mb-4 bg-blue-50 rounded-lg p-4 border-l-4 border-blue-500">
      <p class="text-sm font-semibold text-gray-700 mb-1">
        Classification: <span class="text-blue-600">{{ nameData.recentClassification }}</span>
      </p>
      {% if classificationDescriptions.recent[nameData.recentClassification] %}
      <p class="text-sm text-gray-600">{{ classificationDescriptions.recent[nameData.recentClassification] }}</p>
      {% endif %}
    </div>
    {% endif %}

    <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-4 mb-4">
      <div id="modern-chart" class="w-full" style="height: 400px;"></div>
    </div>

    <details class="mt-4">
      <summary class="cursor-pointer bg-white rounded-lg p-4 hover:bg-gray-50 font-semibold text-gray-700 select-none border border-gray-200">
        View Data Table
      </summary>
      <div class="mt-2 bg-white rounded-lg overflow-hidden border border-gray-200">
        <div class="overflow-x-auto">
          <table class="min-w-full divide-y divide-gray-200">
            <thead class="bg-gray-50">
              <tr>
                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Year</th>
                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Count</th>
                {% if nameData.relatedNames and nameData.relatedNames.length > 0 %}
                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">With Related</th>
                {% endif %}
                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Rank</th>
              </tr>
            </thead>
            <tbody class="bg-white divide-y divide-gray-200">
              {% set startYear = 1996 %}
              {% for rank in nameData.rankFrom1996 %}
              {% set count = nameData.countFrom1996[loop.index0] %}
              {% set relatedCount = nameData.relatedTotalCountFrom1996[loop.index0] %}
              <tr class="{% if loop.index0 % 2 == 0 %}bg-white{% else %}bg-gray-50{% endif %} hover:bg-blue-50">
                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">{{ startYear + loop.index0 }}</td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                  {% if count != 'x' %}{{ count }}{% else %}—{% endif %}
                </td>
                {% if nameData.relatedNames and nameData.relatedNames.length > 0 %}
                <td class="px-6 py-4 whitespace-nowrap text-sm text-purple-600 font-semibold">
                  {% if count != 'x' and relatedCount != 'x' %}{{ (count | int) + (relatedCount | int) }}{% elif count != 'x' %}{{ count }}{% else %}—{% endif %}
                </td>
                {% endif %}
                <td class="px-6 py-4 whitespace-nowrap text-sm {% if rank != 'x' %}text-blue-600 font-semibold{% else %}text-gray-400{% endif %}">
                  {% if rank != 'x' %}#{{ rank }}{% else %}Unranked{% endif %}
                </td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      </div>
    </details>
  </div>
  {% endif %}

  <nav class="pt-6 border-t border-gray-200">
    <a href="/names/" class="text-blue-600 hover:text-blue-700 font-medium">&larr; Back to all names</a>
  </nav>
</article>

<script>
  // Modern rankings dot plot with count on y-axis
  {% if nameData.countFrom1996 and nameData.countFrom1996.length > 0 %}
  (function() {
    const countData = {{ nameData.countFrom1996 | dump | safe }};
    const relatedCountData = {{ nameData.relatedTotalCountFrom1996 | dump | safe }};
    const hasRelated = {{ (nameData.relatedNames and nameData.relatedNames.length > 0) | dump | safe }};
    const startYear = 1996;

    // Prepare main data (name's own count)
    const chartData = countData.map((count, i) => ({
      year: startYear + i,
      count: count === 'x' ? null : parseInt(count)
    })).filter(d => d.count !== null);

    // Prepare combined data (name + related counts)
    const combinedData = hasRelated ? countData.map((count, i) => {
      const relCount = relatedCountData[i];
      const nameCount = count === 'x' ? 0 : parseInt(count);
      const relatedTotal = relCount === 'x' ? 0 : parseInt(relCount);
      return {
        year: startYear + i,
        count: nameCount > 0 || relatedTotal > 0 ? nameCount + relatedTotal : null,
        nameCount: nameCount > 0 ? nameCount : null,
        relatedCount: relatedTotal > 0 ? relatedTotal : null
      };
    }).filter(d => d.count !== null) : [];

    // Find min and max counts (considering both series)
    const allCounts = [...chartData.map(d => d.count), ...combinedData.map(d => d.count)];
    const minCount = allCounts.length > 0 ? Math.min(...allCounts) : 0;
    const maxCount = allCounts.length > 0 ? Math.max(...allCounts) : 0;

    const container = document.getElementById('modern-chart');
    const margin = {top: 20, right: 40, bottom: 60, left: 60};

    function drawChart() {
      d3.select('#modern-chart').selectAll('*').remove();

      const containerWidth = container.clientWidth;
      const width = containerWidth - margin.left - margin.right;
      const height = 400 - margin.top - margin.bottom;

      const svg = d3.select('#modern-chart')
        .append('svg')
        .attr('width', containerWidth)
        .attr('height', 400)
        .append('g')
        .attr('transform', `translate(${margin.left},${margin.top})`);

      // X scale for years (horizontal)
      const xScale = d3.scaleLinear()
        .domain([1996, 2024])
        .range([0, width]);

      // Y scale for count (vertical)
      const yScale = d3.scaleLinear()
        .domain([0, maxCount])
        .range([height, 0]);

      // Add X axis
      svg.append('g')
        .attr('transform', `translate(0,${height})`)
        .call(d3.axisBottom(xScale)
          .ticks(7)
          .tickFormat(d3.format('d')))
        .style('font-size', '12px');

      // Add X axis label
      svg.append('text')
        .attr('x', width / 2)
        .attr('y', height + 50)
        .attr('text-anchor', 'middle')
        .style('font-size', '14px')
        .style('fill', '#6b7280')
        .text('Year');

      // Add Y axis
      svg.append('g')
        .call(d3.axisLeft(yScale)
          .ticks(5)
          .tickFormat(d3.format(',d')))
        .style('font-size', '12px');

      // Add Y axis label
      svg.append('text')
        .attr('transform', 'rotate(-90)')
        .attr('x', -height / 2)
        .attr('y', -45)
        .attr('text-anchor', 'middle')
        .style('font-size', '14px')
        .style('fill', '#6b7280')
        .text('Number of Babies');

      // Add combined series dots (if related names exist) - draw first so main series is on top
      if (hasRelated && combinedData.length > 0) {
        svg.selectAll('.dot-combined')
          .data(combinedData)
          .join('circle')
          .attr('class', 'dot-combined')
          .attr('cx', d => xScale(d.year))
          .attr('cy', d => yScale(d.count))
          .attr('r', 4)
          .attr('fill', '#9333ea')
          .attr('opacity', 0.6)
          .on('mouseover', function(event, d) {
            d3.select(this)
              .attr('r', 6)
              .attr('opacity', 1);

            // Show tooltip
            const tooltip = svg.append('g')
              .attr('class', 'tooltip')
              .attr('transform', `translate(${xScale(d.year) + 10},${yScale(d.count)})`);

            const text = tooltip.append('text')
              .attr('text-anchor', 'start')
              .style('font-size', '11px')
              .style('font-weight', '600')
              .style('fill', '#7e22ce')
              .text(`${d.year}: ${d.count.toLocaleString()} total (${d.nameCount ? d.nameCount.toLocaleString() : 0} + ${d.relatedCount ? d.relatedCount.toLocaleString() : 0})`);

            const bbox = text.node().getBBox();
            tooltip.insert('rect', 'text')
              .attr('x', bbox.x - 4)
              .attr('y', bbox.y - 2)
              .attr('width', bbox.width + 8)
              .attr('height', bbox.height + 4)
              .attr('fill', 'white')
              .attr('stroke', '#9333ea')
              .attr('stroke-width', 1)
              .attr('rx', 3);

            text.raise();
          })
          .on('mouseout', function() {
            d3.select(this)
              .attr('r', 4)
              .attr('opacity', 0.6);
            svg.selectAll('.tooltip').remove();
          });
      }

      // Add main series dots
      svg.selectAll('.dot')
        .data(chartData)
        .join('circle')
        .attr('class', 'dot')
        .attr('cx', d => xScale(d.year))
        .attr('cy', d => yScale(d.count))
        .attr('r', 4)
        .attr('fill', '#3b82f6')
        .attr('opacity', 0.7)
        .on('mouseover', function(event, d) {
          d3.select(this)
            .attr('r', 6)
            .attr('opacity', 1);

          // Show tooltip
          const tooltip = svg.append('g')
            .attr('class', 'tooltip')
            .attr('transform', `translate(${xScale(d.year) + 10},${yScale(d.count)})`);

          const text = tooltip.append('text')
            .attr('text-anchor', 'start')
            .style('font-size', '11px')
            .style('font-weight', '600')
            .style('fill', '#1e40af')
            .text(`${d.year}: ${d.count.toLocaleString()} babies`);

          const bbox = text.node().getBBox();
          tooltip.insert('rect', 'text')
            .attr('x', bbox.x - 4)
            .attr('y', bbox.y - 2)
            .attr('width', bbox.width + 8)
            .attr('height', bbox.height + 4)
            .attr('fill', 'white')
            .attr('stroke', '#3b82f6')
            .attr('stroke-width', 1)
            .attr('rx', 3);

          text.raise();
        })
        .on('mouseout', function() {
          d3.select(this)
            .attr('r', 4)
            .attr('opacity', 0.7);
          svg.selectAll('.tooltip').remove();
        });

      // Add markers for highest and lowest counts
      if (maxCount > 0) {
        const maxData = chartData.find(d => d.count === maxCount);
        if (maxData) {
          svg.append('circle')
            .attr('cx', xScale(maxData.year))
            .attr('cy', yScale(maxData.count))
            .attr('r', 6)
            .attr('fill', '#10b981')
            .attr('stroke', 'white')
            .attr('stroke-width', 2);
        }
      }

      if (minCount > 0 && minCount !== maxCount) {
        const minData = chartData.find(d => d.count === minCount);
        if (minData) {
          svg.append('circle')
            .attr('cx', xScale(minData.year))
            .attr('cy', yScale(minData.count))
            .attr('r', 6)
            .attr('fill', '#ef4444')
            .attr('stroke', 'white')
            .attr('stroke-width', 2);
        }
      }

      // Add legend
      const legend = svg.append('g')
        .attr('class', 'legend')
        .attr('transform', `translate(${width - 180}, 10)`);

      // Main series legend item
      legend.append('circle')
        .attr('cx', 0)
        .attr('cy', 0)
        .attr('r', 4)
        .attr('fill', '#3b82f6')
        .attr('opacity', 0.7);

      legend.append('text')
        .attr('x', 10)
        .attr('y', 0)
        .attr('dy', '0.32em')
        .style('font-size', '12px')
        .style('fill', '#374151')
        .text('This name');

      // Combined series legend item (only if has related names)
      if (hasRelated && combinedData.length > 0) {
        legend.append('circle')
          .attr('cx', 0)
          .attr('cy', 20)
          .attr('r', 4)
          .attr('fill', '#9333ea')
          .attr('opacity', 0.6);

        legend.append('text')
          .attr('x', 10)
          .attr('y', 20)
          .attr('dy', '0.32em')
          .style('font-size', '12px')
          .style('fill', '#374151')
          .text('With related');
      }
    }

    drawChart();

    // Redraw on window resize
    let resizeTimeout;
    window.addEventListener('resize', function() {
      clearTimeout(resizeTimeout);
      resizeTimeout = setTimeout(drawChart, 250);
    });
  })();
  {% endif %}
</script>

<script>
  // Historic rankings chart
  {% if nameData.rankHistoric and nameData.rankHistoric.length > 0 %}
  (function() {
    const data = {{ nameData.rankHistoric | dump | safe }};
    const decades = data.map((rank, i) => ({
      decade: (1900 + i * 10) + 's',
      rank: rank === 'x' ? null : parseInt(rank),
      index: i
    }));

    // Color scale for bars (darker amber for better ranks)
    const colorScale = d3.scaleSequential()
      .domain([100, 1])  // Reversed: 100 to 1, so lower ranks get darker colors
      .interpolator(d3.interpolateOranges);

    // Set up dimensions
    const container = document.getElementById('historic-chart');
    const margin = {top: 20, right: 40, bottom: 60, left: 60};

    function drawChart() {
      // Clear previous chart
      d3.select('#historic-chart').selectAll('*').remove();

      const containerWidth = container.clientWidth;
      const width = containerWidth - margin.left - margin.right;
      const height = 300 - margin.top - margin.bottom;

      // Create SVG
      const svg = d3.select('#historic-chart')
        .append('svg')
        .attr('width', containerWidth)
        .attr('height', 300)
        .append('g')
        .attr('transform', `translate(${margin.left},${margin.top})`);

      // Create scales
      const xScale = d3.scaleLinear()
        .domain([100, 1])  // Inverted: 100 to 1
        .range([0, width]);

      const yScale = d3.scaleBand()
        .domain(decades.map(d => d.decade))
        .range([0, height])
        .padding(0.2);

      // Add X axis
      svg.append('g')
        .attr('transform', `translate(0,${height})`)
        .call(d3.axisBottom(xScale).ticks(5))
        .style('font-size', '12px');

      // Add X axis label
      svg.append('text')
        .attr('x', width / 2)
        .attr('y', height + 50)
        .attr('text-anchor', 'middle')
        .style('font-size', '14px')
        .style('fill', '#6b7280')
        .text('Rank (1 = Most Popular)');

      // Add Y axis
      svg.append('g')
        .call(d3.axisLeft(yScale))
        .style('font-size', '12px');

      // Add Y axis label
      svg.append('text')
        .attr('transform', 'rotate(-90)')
        .attr('x', -height / 2)
        .attr('y', -45)
        .attr('text-anchor', 'middle')
        .style('font-size', '14px')
        .style('fill', '#6b7280')
        .text('Decade');

      // Add bars
      svg.selectAll('.bar')
        .data(decades)
        .join('rect')
        .attr('class', 'bar')
        .attr('x', 0)
        .attr('y', d => yScale(d.decade))
        .attr('width', d => d.rank ? xScale(d.rank) : 0)
        .attr('height', yScale.bandwidth())
        .attr('fill', d => d.rank ? '#93c5fd' : '#e5e7eb')
        .attr('opacity', 1)
        .attr('stroke', d => d.rank ? '#3b82f6' : '#d1d5db')
        .attr('stroke-width', 1)
        .style('cursor', d => d.rank ? 'pointer' : 'default')
        .on('mouseover', function(event, d) {
          if (d.rank) {
            d3.select(this).attr('opacity', 0.8);
          }
        })
        .on('mouseout', function(event, d) {
          if (d.rank) {
            d3.select(this).attr('opacity', 1);
          }
        });

      // Add rank labels on bars
      svg.selectAll('.label')
        .data(decades.filter(d => d.rank))
        .join('text')
        .attr('class', 'label')
        .attr('x', d => xScale(d.rank) - 5)
        .attr('y', d => yScale(d.decade) + yScale.bandwidth() / 2)
        .attr('dy', '0.35em')
        .attr('text-anchor', 'end')
        .style('font-size', '12px')
        .style('font-weight', '600')
        .style('fill', '#1e40af')
        .text(d => `#${d.rank}`);
    }

    // Initial draw
    drawChart();

    // Redraw on window resize
    let resizeTimeout;
    window.addEventListener('resize', function() {
      clearTimeout(resizeTimeout);
      resizeTimeout = setTimeout(drawChart, 250);
    });
  })();
  {% endif %}
</script>
{% endblock %}
