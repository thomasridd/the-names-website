---
pagination:
  data: allNames
  size: 1
  alias: nameData
permalink: /names/{{ nameData.gender | lower }}/{{ nameData.uniqueSlug }}/
---

{% extends "base.njk" %}

{% block title %}{{ nameData.name }} - {{ siteConfig.title }}{% endblock %}
{% block description %}Discover {{ nameData.name }}: A {{ nameData.gender }}'s name ranked #{{ nameData.rank }} with detailed popularity trends and historical data.{% endblock %}

{% block content %}
<article class="bg-white rounded-lg p-8 shadow-sm">
  <h1 class="text-5xl font-bold mb-2 text-gray-900">{{ nameData.name }}</h1>

  {% if nameData.gender %}
  <p class="text-xl text-gray-600 mb-8">{{ nameData.gender }}'s Name</p>
  {% endif %}

  <div class="grid md:grid-cols-2 gap-8 mb-8">
    <div class="bg-gradient-to-br from-blue-50 to-indigo-50 rounded-lg p-6">
      <h2 class="text-sm font-semibold text-gray-600 uppercase tracking-wide mb-2">Current Rank</h2>
      <p class="text-4xl font-bold text-blue-600">#{{ nameData.rank }}</p>
      <p class="text-sm text-gray-600 mt-2">2024 popularity ranking</p>
    </div>

    <div class="bg-gradient-to-br from-green-50 to-emerald-50 rounded-lg p-6">
      <h2 class="text-sm font-semibold text-gray-600 uppercase tracking-wide mb-2">Babies Named</h2>
      <p class="text-4xl font-bold text-green-600">{{ nameData.count }}</p>
      <p class="text-sm text-gray-600 mt-2">in 2024</p>
    </div>
  </div>

  {% if nameData.rankFrom1996 and nameData.rankFrom1996.length > 0 %}
  <div class="mb-8 bg-gray-50 rounded-lg p-6">
    <h2 class="text-2xl font-bold mb-4 text-gray-900">Modern Rankings</h2>
    <p class="text-gray-700 mb-4">Rankings from 1996 to 2024 (29 years)</p>

    {% if nameData.recentClassification %}
    <div class="mb-4 bg-white rounded-lg p-4 border-l-4 border-blue-500">
      <p class="text-sm font-semibold text-gray-700 mb-1">
        Classification: <span class="text-blue-600">{{ nameData.recentClassification }}</span>
      </p>
      {% if classificationDescriptions.recent[nameData.recentClassification] %}
      <p class="text-sm text-gray-600">{{ classificationDescriptions.recent[nameData.recentClassification] }}</p>
      {% endif %}
    </div>
    {% endif %}

    <div class="bg-white rounded p-4">
      <div id="modern-heatmap" class="w-full"></div>
    </div>

    <details class="mt-4">
      <summary class="cursor-pointer bg-white rounded-lg p-4 hover:bg-gray-50 font-semibold text-gray-700 select-none">
        View Data Table
      </summary>
      <div class="mt-2 bg-white rounded-lg overflow-hidden border border-gray-200">
        <div class="overflow-x-auto">
          <table class="min-w-full divide-y divide-gray-200">
            <thead class="bg-gray-50">
              <tr>
                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Year</th>
                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Rank</th>
              </tr>
            </thead>
            <tbody class="bg-white divide-y divide-gray-200">
              {% set startYear = 1996 %}
              {% for rank in nameData.rankFrom1996 %}
              <tr class="{% if loop.index0 % 2 == 0 %}bg-white{% else %}bg-gray-50{% endif %} hover:bg-blue-50">
                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">{{ startYear + loop.index0 }}</td>
                <td class="px-6 py-4 whitespace-nowrap text-sm {% if rank != 'x' %}text-blue-600 font-semibold{% else %}text-gray-400{% endif %}">
                  {% if rank != 'x' %}#{{ rank }}{% else %}Unranked{% endif %}
                </td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      </div>
    </details>
  </div>
  {% endif %}

  {% if nameData.rankHistoric and nameData.rankHistoric.length > 0 %}
  <div class="mb-8 bg-gray-50 rounded-lg p-6">
    <h2 class="text-2xl font-bold mb-4 text-gray-900">Historic Rankings</h2>
    <p class="text-gray-700 mb-4">Top 100 rankings from 1904 to 2024</p>

    {% if nameData.historicClassification %}
    <div class="mb-4 bg-white rounded-lg p-4 border-l-4 border-amber-500">
      <p class="text-sm font-semibold text-gray-700 mb-1">
        Classification: <span class="text-amber-600">{{ nameData.historicClassification }}</span>
      </p>
      {% if classificationDescriptions.historic[nameData.historicClassification] %}
      <p class="text-sm text-gray-600">{{ classificationDescriptions.historic[nameData.historicClassification] }}</p>
      {% endif %}
    </div>
    {% endif %}

    <div class="bg-white rounded p-4">
      <div id="historic-chart" class="w-full" style="height: 300px;"></div>
    </div>

    <details class="mt-4">
      <summary class="cursor-pointer bg-white rounded-lg p-4 hover:bg-gray-50 font-semibold text-gray-700 select-none">
        View Data Table
      </summary>
      <div class="mt-2 bg-white rounded-lg overflow-hidden border border-gray-200">
        <div class="overflow-x-auto">
          <table class="min-w-full divide-y divide-gray-200">
            <thead class="bg-gray-50">
              <tr>
                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Decade</th>
                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Rank</th>
              </tr>
            </thead>
            <tbody class="bg-white divide-y divide-gray-200">
              {% for rank in nameData.rankHistoric %}
              {% set decade = 1900 + (loop.index0 * 10) %}
              <tr class="{% if loop.index0 % 2 == 0 %}bg-white{% else %}bg-gray-50{% endif %} hover:bg-amber-50">
                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">{{ decade }}s</td>
                <td class="px-6 py-4 whitespace-nowrap text-sm {% if rank != 'x' %}text-amber-600 font-semibold{% else %}text-gray-400{% endif %}">
                  {% if rank != 'x' %}#{{ rank }}{% else %}Not in Top 100{% endif %}
                </td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      </div>
    </details>
  </div>
  {% endif %}

  <nav class="pt-6 border-t border-gray-200">
    <a href="/names/" class="text-blue-600 hover:text-blue-700 font-medium">&larr; Back to all names</a>
  </nav>
</article>

<script>
  // Modern rankings heatmap
  {% if nameData.rankFrom1996 and nameData.rankFrom1996.length > 0 %}
  (function() {
    const data = {{ nameData.rankFrom1996 | dump | safe }};
    const startYear = 1996;
    const yearsPerRow = 5;

    // Prepare data for heatmap
    const heatmapData = data.map((rank, i) => ({
      year: startYear + i,
      rank: rank === 'x' ? null : parseInt(rank),
      yearIndex: i
    }));

    // Group into rows of 5
    const rows = [];
    for (let i = 0; i < heatmapData.length; i += yearsPerRow) {
      rows.push({
        startYear: heatmapData[i].year,
        data: heatmapData.slice(i, i + yearsPerRow)
      });
    }

    const container = d3.select('#modern-heatmap');
    const cellSize = 80;
    const cellPadding = 4;
    const labelWidth = 60;

    // Color scale (darker blue for better ranks/lower numbers)
    const colorScale = d3.scaleSequential()
      .domain([500, 1])  // Reversed: 500 to 1, so lower ranks get darker colors
      .interpolator(d3.interpolateBlues);

    function drawHeatmap() {
      container.selectAll('*').remove();

      const svg = container
        .append('svg')
        .attr('width', '100%')
        .attr('height', rows.length * (cellSize + cellPadding) + 20);

      rows.forEach((row, rowIndex) => {
        const rowGroup = svg.append('g')
          .attr('transform', `translate(0, ${rowIndex * (cellSize + cellPadding)})`);

        // Row label
        rowGroup.append('text')
          .attr('x', 5)
          .attr('y', cellSize / 2)
          .attr('dy', '0.35em')
          .style('font-size', '14px')
          .style('font-weight', '600')
          .style('fill', '#374151')
          .text(row.startYear);

        // Cells
        row.data.forEach((d, cellIndex) => {
          const cellGroup = rowGroup.append('g')
            .attr('transform', `translate(${labelWidth + cellIndex * (cellSize + cellPadding)}, 0)`);

          // Cell background
          cellGroup.append('rect')
            .attr('width', cellSize)
            .attr('height', cellSize)
            .attr('rx', 4)
            .attr('fill', d.rank ? colorScale(d.rank) : '#f3f4f6')
            .attr('stroke', d.rank ? '#1e40af' : '#d1d5db')
            .attr('stroke-width', 1)
            .style('cursor', d.rank ? 'pointer' : 'default')
            .on('mouseover', function() {
              if (d.rank) {
                d3.select(this)
                  .attr('stroke-width', 2)
                  .attr('stroke', '#1e3a8a');
              }
            })
            .on('mouseout', function() {
              if (d.rank) {
                d3.select(this)
                  .attr('stroke-width', 1)
                  .attr('stroke', '#1e40af');
              }
            });

          // Year label (last two digits)
          cellGroup.append('text')
            .attr('x', cellSize / 2)
            .attr('y', 20)
            .attr('text-anchor', 'middle')
            .style('font-size', '11px')
            .style('font-weight', '500')
            .style('fill', d.rank && d.rank <= 100 ? '#ffffff' : '#6b7280')
            .text(`'${String(d.year).slice(-2)}`);

          // Rank label
          cellGroup.append('text')
            .attr('x', cellSize / 2)
            .attr('y', cellSize / 2 + 8)
            .attr('text-anchor', 'middle')
            .style('font-size', '18px')
            .style('font-weight', '700')
            .style('fill', d.rank && d.rank <= 100 ? '#ffffff' : '#9ca3af')
            .text(d.rank ? `#${d.rank}` : 'â€”');
        });
      });
    }

    drawHeatmap();

    // Redraw on window resize
    let resizeTimeout;
    window.addEventListener('resize', function() {
      clearTimeout(resizeTimeout);
      resizeTimeout = setTimeout(drawHeatmap, 250);
    });
  })();
  {% endif %}
</script>

<script>
  // Historic rankings chart
  {% if nameData.rankHistoric and nameData.rankHistoric.length > 0 %}
  (function() {
    const data = {{ nameData.rankHistoric | dump | safe }};
    const decades = data.map((rank, i) => ({
      decade: (1900 + i * 10) + 's',
      rank: rank === 'x' ? null : parseInt(rank),
      index: i
    }));

    // Set up dimensions
    const container = document.getElementById('historic-chart');
    const margin = {top: 20, right: 40, bottom: 60, left: 60};

    function drawChart() {
      // Clear previous chart
      d3.select('#historic-chart').selectAll('*').remove();

      const containerWidth = container.clientWidth;
      const width = containerWidth - margin.left - margin.right;
      const height = 300 - margin.top - margin.bottom;

      // Create SVG
      const svg = d3.select('#historic-chart')
        .append('svg')
        .attr('width', containerWidth)
        .attr('height', 300)
        .append('g')
        .attr('transform', `translate(${margin.left},${margin.top})`);

      // Create scales
      const xScale = d3.scaleLinear()
        .domain([100, 1])  // Inverted: 100 to 1
        .range([0, width]);

      const yScale = d3.scaleBand()
        .domain(decades.map(d => d.decade))
        .range([0, height])
        .padding(0.2);

      // Add X axis
      svg.append('g')
        .attr('transform', `translate(0,${height})`)
        .call(d3.axisBottom(xScale).ticks(5))
        .style('font-size', '12px');

      // Add X axis label
      svg.append('text')
        .attr('x', width / 2)
        .attr('y', height + 50)
        .attr('text-anchor', 'middle')
        .style('font-size', '14px')
        .style('fill', '#6b7280')
        .text('Rank (1 = Most Popular)');

      // Add Y axis
      svg.append('g')
        .call(d3.axisLeft(yScale))
        .style('font-size', '12px');

      // Add Y axis label
      svg.append('text')
        .attr('transform', 'rotate(-90)')
        .attr('x', -height / 2)
        .attr('y', -45)
        .attr('text-anchor', 'middle')
        .style('font-size', '14px')
        .style('fill', '#6b7280')
        .text('Decade');

      // Add bars
      svg.selectAll('.bar')
        .data(decades)
        .join('rect')
        .attr('class', 'bar')
        .attr('x', d => d.rank ? xScale(100) : xScale(100))
        .attr('y', d => yScale(d.decade))
        .attr('width', d => d.rank ? xScale(100) - xScale(d.rank) : 0)
        .attr('height', yScale.bandwidth())
        .attr('fill', d => d.rank ? '#f59e0b' : '#e5e7eb')
        .attr('stroke', d => d.rank ? '#d97706' : '#d1d5db')
        .attr('stroke-width', 1)
        .style('cursor', d => d.rank ? 'pointer' : 'default')
        .on('mouseover', function(event, d) {
          if (d.rank) {
            d3.select(this).attr('fill', '#d97706');
          }
        })
        .on('mouseout', function(event, d) {
          if (d.rank) {
            d3.select(this).attr('fill', '#f59e0b');
          }
        });

      // Add rank labels on bars
      svg.selectAll('.label')
        .data(decades.filter(d => d.rank))
        .join('text')
        .attr('class', 'label')
        .attr('x', d => xScale(d.rank) - 5)
        .attr('y', d => yScale(d.decade) + yScale.bandwidth() / 2)
        .attr('dy', '0.35em')
        .attr('text-anchor', 'end')
        .style('font-size', '12px')
        .style('font-weight', '600')
        .style('fill', '#78350f')
        .text(d => `#${d.rank}`);
    }

    // Initial draw
    drawChart();

    // Redraw on window resize
    let resizeTimeout;
    window.addEventListener('resize', function() {
      clearTimeout(resizeTimeout);
      resizeTimeout = setTimeout(drawChart, 250);
    });
  })();
  {% endif %}
</script>
{% endblock %}
